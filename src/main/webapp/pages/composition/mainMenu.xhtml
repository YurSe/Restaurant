<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:form>
        <p:menubar>
            <p:menuitem value="Главная" outcome="/pages/index?faces-redirect=true"/>
            <p:menuitem value="Меню" outcome="/pages/menu?faces-redirect=true"/>
            <p:menuitem value="Забронировать столик" outcome="/pages/zones?faces-redirect=true"/>
            <p:menuitem value="Поиск" outcome="/pages/search?faces-redirect=true"/>
            <p:menuitem value="Галерея" outcome="/pages/gallery?faces-redirect=true"/>
            <p:menuitem value="События" outcome="/pages/events?faces-redirect=true"/>
            <p:menuitem value="Услуги" outcome="/pages/services?faces-redirect=true"/>
            <p:menuitem value="Контакты" outcome="/pages/contacts?faces-redirect=true"/>
            <p:menuitem value="О ресторане" outcome="/pages/about?faces-redirect=true"/>

            <p:menuitem id="basketButton" value="Корзина" type="button" style="position: absolute; right: 9%;"
                        rendered="#{springUserController.IsAuthorized()}"
                        onclick="PF('basketPanelVar').loadContents()"/>

            <p:menuitem ajax="false" value="Выйти" url="/logout"
                        style="position: absolute; right: 1%;" rendered="#{springUserController.IsAuthorized()}"/>

            <p:menuitem id="LogIn" value="Войти" action="login?faces-redirect=true"
                        style="position: absolute; right: 9%;" rendered="#{!springUserController.IsAuthorized()}"/>
            <p:menuitem id="Registration" value="Регистрация" action="register?faces-redirect=true"
                        rendered="#{!springUserController.IsAuthorized()}"
                        style="position: absolute; right: 1%;"/>
        </p:menubar>

        <p:overlayPanel id="basketPanel" for="basketButton" hideEffect="fade" dynamic="true" style="width:50%;"
                        widgetVar="basketPanelVar">
            <p:dataTable id="basketDataTable" var="dish" value="#{reservation.dishList}" rows="5"
                         emptyMessage="Корзина пуста"
                         paginator="true">
                <p:column headerText="Название">
                    <h:outputText value="#{dish.name}"/>
                </p:column>

                <p:column headerText="Цена">
                    <h:outputText value="#{dish.price}"/>
                </p:column>

                <p:column headerText="Кол-во">
                    <h:outputText value="#{reservation.dishes[dish]}"/>
                </p:column>

                <p:column headerText="Удалить" style="width: 20%;">
                    <p:commandButton value="X" style="background-color: red;"
                                     update="basketDataTable"
                                     action="#{reservation.RemoveDish(dish)}"/>
                </p:column>
            </p:dataTable>
            <p:commandButton value="Заказать" rendered="#{!reservation.IsDishesEmpty()}"
                             actionListener="#{reservation.createOrder()}"/>
        </p:overlayPanel>

    </h:form>
</ui:composition>
